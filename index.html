<!DOCTYPE html>
<html>
<head>
<title>Smart Dictionary</title>

<style>
body{
    font-family: Arial;
    margin:0;
    background:#f5f5f5;
}

.topbar{
    position:sticky;
    top:0;
    background:white;
    padding:12px 20px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    box-shadow:0 2px 8px rgba(0,0,0,0.08);
}

.title{
    font-size:20px;
    font-weight:bold;
}

.pill-toggle{
    display:flex;
    background:#e0e0e0;
    border-radius:999px;
    padding:4px;
}

.pill-btn{
    border:none;
    padding:8px 18px;
    border-radius:999px;
    cursor:pointer;
    font-weight:bold;
    background:transparent;
}

.pill-btn.active{
    background:#007bff;
    color:white;
}

.container{
    padding:20px;
}

input{
    width:100%;
    padding:10px;
    border-radius:6px;
    border:1px solid #ccc;
    margin-bottom:10px;
}

.topic{
    background:white;
    padding:15px;
    margin-bottom:18px;
    border-radius:8px;
}

.topic h2{
    cursor:pointer;
    margin:0;
}

.subtopic{
    margin-left:15px;
    margin-top:10px;
}

.word{
    margin-left:30px;
    margin-bottom:10px;
}

.result{
    background:#fff3cd;
    padding:8px;
    border-radius:6px;
    margin-bottom:6px;
    cursor:pointer;
}

.empty{
    text-align:center;
    padding:40px;
    color:#888;
}

#scrollTopBtn{
    position:fixed;
    bottom:25px;
    right:25px;
    display:none;
    border:none;
    border-radius:50%;
    background:#007bff;
    color:white;
    padding:12px;
    cursor:pointer;
}
</style>
</head>

<body>

<div class="topbar">
<div class="title">üìò Smart Dictionary</div>

<div class="pill-toggle">
<button id="englishBtn" class="pill-btn">English</button>
<button id="telugishBtn" class="pill-btn">Telugish</button>
</div>
</div>

<div class="container">

<input type="text" id="searchBox" placeholder="Search word...">

<div id="suggestions"></div>
<div id="searchResults"></div>
<div id="dictionary"></div>

</div>

<button id="scrollTopBtn">‚¨Ü</button>

<script>

let mergedDictionary={}
let currentLanguage=localStorage.getItem("lang")||"english"
let openedTopics = new Set()

/* ‚≠ê Topic Order */
const topicOrder = [
    "Algorithms & Basics",
    "Basic Linux Commands",
    "Directory Exploration and Deletion",
    "File execution flow",
    "Python Programming (Basic ‚Üí Core)",
    "Call Stack (C Language & Python)",
    "Creating a Static Webpage using Basic HTML",
    "Code Checking & Submission Tools",
    "NotebookLM tasks",
    "Gamma.ai",
    "ElevenLabs Text to Audio",
    "Contact QR Generation using cURL (URL ‚Üí QR)",
    "General Error Concepts"
]

/* ---------- Load JSON ---------- */

async function loadDictionary(){

    try{
        let res = await fetch("dictionary.json")
        mergedDictionary = await res.json()
        displayDictionary()
    }
    catch(err){
        dictionary.innerHTML=`<div class="empty">‚ùå Failed to load dictionary.json</div>`
        console.error(err)
    }
}

loadDictionary()

/* ---------- Language Toggle ---------- */

function setLanguage(lang){

    currentLanguage=lang
    localStorage.setItem("lang",lang)

    englishBtn.classList.toggle("active",lang==="english")
    telugishBtn.classList.toggle("active",lang==="telugish")

    displayDictionary()
    searchBox.dispatchEvent(new Event("input"))
}

englishBtn.onclick=()=>setLanguage("english")
telugishBtn.onclick=()=>setLanguage("telugish")

setLanguage(currentLanguage)

/* ---------- Display ---------- */

function getMeaning(item){
    return currentLanguage==="english"?item.english:item.telugish
}

function createTopicUI(topic){

    let count=0
    Object.values(mergedDictionary[topic]).forEach(arr=>count+=arr.length)

    let topicDiv=document.createElement("div")
    topicDiv.className="topic"

    let header=document.createElement("h2")
    let body=document.createElement("div")

    let isOpen = openedTopics.has(topic)
    body.style.display = isOpen ? "block" : "none"

    header.innerHTML = isOpen
        ? `‚ñº üìò ${topic} (${count})`
        : `‚ñ∂ üìò ${topic} (${count})`

    header.onclick=()=>{
        let open=body.style.display==="none"

        body.style.display=open?"block":"none"

        header.innerHTML=open
            ? `‚ñº üìò ${topic} (${count})`
            : `‚ñ∂ üìò ${topic} (${count})`

        if(open){
            openedTopics.add(topic)
        }else{
            openedTopics.delete(topic)
        }
    }

    for(let sub in mergedDictionary[topic]){

        let subDiv=document.createElement("div")
        subDiv.className="subtopic"
        subDiv.innerHTML=`<h3>üîπ ${sub}</h3>`

        mergedDictionary[topic][sub].forEach(item=>{

            let meaning=getMeaning(item)
            if(!meaning) return

            let div=document.createElement("div")
            div.className="word"
            div.innerHTML=`<b>${item.word}</b><br>${meaning}`

            subDiv.appendChild(div)
        })

        body.appendChild(subDiv)
    }

    topicDiv.appendChild(header)
    topicDiv.appendChild(body)

    dictionary.appendChild(topicDiv)
}

function displayDictionary(){

    dictionary.innerHTML=""

    if(!Object.keys(mergedDictionary).length){
        dictionary.innerHTML=`<div class="empty">Dictionary is empty</div>`
        return
    }

    /* ‚≠ê Show topics in custom order */
    for(let topic of topicOrder){
        if(mergedDictionary[topic]){
            createTopicUI(topic)
        }
    }

    /* ‚≠ê Show remaining topics */
    for(let topic in mergedDictionary){
        if(topicOrder.includes(topic)) continue
        createTopicUI(topic)
    }
}

/* ---------- Search ---------- */

searchBox.addEventListener("input",function(){

    let q=this.value.toLowerCase()
    suggestions.innerHTML=""
    searchResults.innerHTML=""

    if(!q) return

    let matches=[]

    for(let topic in mergedDictionary){
        for(let sub in mergedDictionary[topic]){

            mergedDictionary[topic][sub].forEach(item=>{

                if(item.word.toLowerCase().includes(q)){

                    matches.push(item.word)

                    let div=document.createElement("div")
                    div.className="result"
                    div.innerHTML=`<b>${item.word}</b><br>${getMeaning(item)}`
                    searchResults.appendChild(div)
                }
            })
        }
    }

    if(!matches.length){
        searchResults.innerHTML=`<div class="empty">No results found</div>`
    }

    matches.slice(0,5).forEach(word=>{
        let s=document.createElement("div")
        s.className="result"
        s.innerText=word
        s.onclick=()=>{
            searchBox.value=word
            searchBox.dispatchEvent(new Event("input"))
        }
        suggestions.appendChild(s)
    })
})

/* ---------- Scroll ---------- */

window.onscroll=()=>{
    scrollTopBtn.style.display=window.scrollY>200?"block":"none"
}

scrollTopBtn.onclick=()=>{
    window.scrollTo({top:0,behavior:"smooth"})
}

</script>

</body>
</html>
